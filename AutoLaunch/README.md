# iTerm2: Автоматический SSH-туннель

Этот Python-скрипт автоматически проверяет и устанавливает SSH-туннель через SOCKS-прокси при запуске iTerm2. Идеальное решение для разработчиков, которым нужно стабильное подключение к удалённым серверам.

## Возможности

- Автоматическая проверка активности SSH-туннеля
- Проверка доступности сервера перед подключением
- Запуск SSH-туннеля в фоновом режиме
- Наглядные уведомления в macOS о статусе подключения

## Установка

1. **Включите Python API в iTerm2**:
   - Откройте `iTerm2 → Настройки → Вкладка General → Секция Magic`
   - Активируйте опцию `Enable Python API`

2. **Установите скрипт**:
   ```bash
   mkdir -p ~/Library/Application\ Support/iTerm2/Scripts/AutoLaunch
   cp auto_ssh_proxy.py ~/Library/Application\ Support/iTerm2/Scripts/AutoLaunch/
   ```

3. **Разрешите выполнение скриптов**:
   - При первом запуске iTerm2 запросит разрешение на выполнение скриптов
   - Нажмите "Разрешить"

## Требования

- macOS
- Установленные утилиты: `ssh`, `lsof`, `ping`
- Python 3.7 или новее
- iTerm2 с поддержкой Python API
- Настроенный доступ по SSH-ключу

## Как это работает

1. Скрипт проверяет активность SSH-туннеля на указанном порту
2. Если туннель неактивен, проверяет доступность сервера
3. При успешной проверке запускает SSH-туннель командой:
   ```bash
   ssh -D SSH_PORT -N -f SSH_USER@SSH_HOST
   ```

## Рекомендации по безопасности

1. Всегда используйте SSH-ключи с паролем
2. Настройте `~/.ssh/config` для удобства:
   ```bash
   Host myproxy
     HostName SSH_HOST
     User root
     IdentityFile ~/.ssh/id_rsa
   ```
3. Затем используйте алиас в скрипте:
   ```bash
   ssh -D SSH_PORT -N -f myproxy
   ```

## Пример использования

1. Откройте iTerm2
2. Скрипт автоматически проверит и установит туннель при необходимости
3. Вы получите уведомление о статусе подключения

## Уведомления

- Туннель уже активен
- Сервер недоступен
- Успешное подключение
- Ошибка при подключении